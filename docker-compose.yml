version: '3.8'
services:

  mongodb:
    image: mongo_ha:latest
    
    volumes:
      - db_data:/data/db
     

    networks:
    - internal-network

    



  frontend:
    image: abiliang1/frontend:latest
      
    ports:
      - "8080:80"
    


    networks:
    - internal-network

  device_integration:
    image: abiliang1/device_integration:latest

    ports:
      - "3000:3000"


    networks:
    - internal-network

  dashboard-backend:
    image: abiliang1/dashboard-backend:latest

    command: sh -c "npm install && npm start"
    ports:
      - "3010:3010"
    environment:
      - MONGO_URL=mongodb://mongodb:27017/dashboard


    networks:
      - internal-network

  

volumes:
  db_data:


networks:
  internal-network:
    driver: overlay